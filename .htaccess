# Proteção do Sistema de Upload - Versão para XAMPP
# Se este arquivo ainda causar erro 500, delete-o e o sistema funcionará sem proteções

# Define index.php como página padrão
DirectoryIndex index.php index.html

# Previne listagem de diretórios
Options -Indexes

# Headers CORS para permitir recursos do Cloudflare e outros serviços
<IfModule mod_headers.c>
    # Permite recursos do Cloudflare Insights
    Header set Access-Control-Allow-Origin "*"
    Header set Access-Control-Allow-Methods "GET, POST, OPTIONS"
    Header set Access-Control-Allow-Headers "Content-Type, Authorization"
</IfModule>

# Configurações para uploads grandes (gigabytes)
# NOTA: php_value pode causar erro 500 em alguns servidores
# Se precisar dessas configurações, ajuste no php.ini do servidor
# As linhas abaixo estão comentadas para evitar erro 500
# php_value upload_max_filesize 5G
# php_value post_max_size 5G
# php_value max_execution_time 0
# php_value max_input_time 0
# php_value memory_limit 1G
# php_value default_socket_timeout 3600

# Páginas de erro personalizadas
ErrorDocument 400 /errors/400.php
ErrorDocument 401 /errors/401.php
ErrorDocument 403 /errors/403.php
ErrorDocument 404 /errors/404.php
ErrorDocument 500 /errors/500.php
ErrorDocument 503 /errors/503.php

# Redireciona raiz para index.php se não especificar arquivo
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} !^/index\.php$
    RewriteRule ^$ index.php [L]
</IfModule>

# Proteção básica - bloqueia acesso direto a arquivos sensíveis
<FilesMatch "^config\.php$">
    Require all denied
</FilesMatch>

<FilesMatch "^.*\.log$">
    Require all denied
</FilesMatch>
